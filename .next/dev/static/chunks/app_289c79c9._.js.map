{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/ArcheryGame.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { jsx } from \"react/jsx-runtime\";\n\n/**\n * Mobile-first Archery mini-game (canvas)\n * - Drag to aim + power\n * - Gravity arc + dotted trajectory preview\n * - Candle hitboxes + sparks\n * - Optional haptics + synthesized sounds (default OFF)\n * - Calls onComplete({ shots, timeMs }) when all candles are out\n *\n * Visuals are tuned to match the BirthdayCard palette:\n * warm amber + cool ink-cyan on a dark, papery gradient.\n */\nexport default function ArcheryGame({\n  onComplete,\n  candleCount = 7,\n  height = 420,\n  showToggles = true,\n  defaultHaptics = false,\n  defaultSound = false,\n}) {\n  const canvasRef = useRef(null);\n  const rafRef = useRef(0);\n  const audioCtxRef = useRef(null);\n\n  const [shots, setShots] = useState(0);\n  const [done, setDone] = useState(false);\n\n  const [hint, setHint] = useState(\"Drag to aim. Release to shoot.\");\n  const [hapticsOn, setHapticsOn] = useState(defaultHaptics);\n  const [soundOn, setSoundOn] = useState(defaultSound);\n\n  const hapticsRef = useRef(defaultHaptics);\n  const soundRef = useRef(defaultSound);\n  useEffect(() => { hapticsRef.current = hapticsOn; }, [hapticsOn]);\n  useEffect(() => { soundRef.current = soundOn; }, [soundOn]);\n\n  const startTimeRef = useRef(0);\n\n  const config = useMemo(\n    () => ({\n      gravity: 1600, // px/s^2\n      maxPower: 1200, // px/s\n      minPower: 420, // px/s\n      windMax: 90, // px/s horizontal accel\n      trailDots: 26,\n\n      candleW: 16,\n      candleH: 54,\n\n      arrowW: 34,\n      arrowH: 6,\n\n      // Palette (matching BirthdayCard-ish)\n      ink: \"rgba(190, 240, 255, 0.95)\",       // cool ink cyan\n      inkSoft: \"rgba(190, 240, 255, 0.35)\",\n      amber: \"rgba(255, 210, 122, 0.95)\",     // warm candle amber\n      amberSoft: \"rgba(255, 210, 122, 0.35)\",\n      paperLine: \"rgba(255,255,255,0.10)\",\n      bgTop: \"rgba(255,255,255,0.06)\",\n      bgBot: \"rgba(255,255,255,0.03)\",\n    }),\n    []\n  );\n\n  const vibrate = (pattern) => {\n    if (!hapticsRef.current) return;\n    if (typeof navigator === \"undefined\") return;\n    if (typeof navigator.vibrate !== \"function\") return;\n    try {\n      navigator.vibrate(pattern);\n    } catch {\n      // ignore\n    }\n  };\n\n  const ensureAudioCtx = async () => {\n    if (!soundRef.current) return null;\n    if (typeof window === \"undefined\") return null;\n    const AC = window.AudioContext || window.webkitAudioContext;\n    if (!AC) return null;\n\n    if (!audioCtxRef.current) audioCtxRef.current = new AC();\n    // iOS requires resume from a gesture\n    if (audioCtxRef.current.state === \"suspended\") {\n      try {\n        await audioCtxRef.current.resume();\n      } catch {\n        // ignore\n      }\n    }\n    return audioCtxRef.current;\n  };\n\n  const blip = async ({ freq = 520, dur = 0.06, type = \"sine\", gain = 0.05 } = {}) => {\n    if (!soundRef.current) return;\n    const ctx = await ensureAudioCtx();\n    if (!ctx) return;\n\n    const o = ctx.createOscillator();\n    const g = ctx.createGain();\n    o.type = type;\n    o.frequency.value = freq;\n\n    g.gain.value = 0;\n    g.gain.linearRampToValueAtTime(gain, ctx.currentTime + 0.005);\n    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur);\n\n    o.connect(g);\n    g.connect(ctx.destination);\n\n    o.start();\n    o.stop(ctx.currentTime + dur + 0.02);\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\", { alpha: true });\n\n    // HiDPI setup\n    const dpr = Math.max(1, window.devicePixelRatio || 1);\n    const resize = () => {\n      const cssW = canvas.clientWidth;\n      const cssH = canvas.clientHeight;\n      canvas.width = Math.floor(cssW * dpr);\n      canvas.height = Math.floor(cssH * dpr);\n      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n    };\n    resize();\n    window.addEventListener(\"resize\", resize);\n\n    const state = {\n      aiming: false,\n      origin: { x: 78, y: height - 78 },        // launch: bottom-left-ish\n      aimNow: { x: 120, y: height - 120 },\n\n      arrows: [],\n      sparks: [],\n\n      lastTs: performance.now(),\n      wind: (Math.random() * 2 - 1) * config.windMax,\n\n      candles: [],\n      w: canvas.clientWidth,\n      h: canvas.clientHeight,\n\n      completed: false,\n    };\n\n    const rand = (a, b) => a + Math.random() * (b - a);\n\n    const resetCandles = () => {\n      const w = canvas.clientWidth;\n      const h = canvas.clientHeight;\n\n      // Place candles on a cake-ish baseline\n      const cakeY = Math.max(140, Math.min(h * 0.55, h - 160));\n      const startX = Math.max(w * 0.46, w - (candleCount * 36 + 60));\n      state.candles = Array.from({ length: candleCount }).map((_, i) => ({\n        x: startX + i * 36 + rand(-3, 3),\n        y: cakeY + rand(-6, 6),\n        w: config.candleW,\n        h: config.candleH,\n        lit: true,\n        flicker: rand(0, 20),\n        wiggle: 0,\n      }));\n    };\n    resetCandles();\n\n    // Helpers\n    const clamp01 = (x) => Math.max(0, Math.min(1, x));\n    const rectsIntersect = (a, b) =>\n      a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;\n\n    const spawnSparks = (x, y) => {\n      for (let i = 0; i < 22; i++) {\n        state.sparks.push({\n          x,\n          y,\n          vx: (Math.random() - 0.5) * 480,\n          vy: (Math.random() - 0.9) * 520,\n          life: 0.55 + Math.random() * 0.25,\n          size: rand(1, 2.2),\n        });\n      }\n    };\n\n    const shoot = async () => {\n      const dx = state.origin.x - state.aimNow.x;\n      const dy = state.origin.y - state.aimNow.y;\n\n      let dist = Math.hypot(dx, dy) * 7.2;\n      dist = Math.max(config.minPower, Math.min(config.maxPower, dist));\n\n      const angle = Math.atan2(dy, dx);\n\n      state.arrows.push({\n        x: state.origin.x,\n        y: state.origin.y,\n        w: config.arrowW,\n        h: config.arrowH,\n        vx: Math.cos(angle) * dist,\n        vy: Math.sin(angle) * dist,\n        rot: angle,\n        alive: true,\n      });\n\n      setShots((s) => s + 1);\n      setHint(\"Again. Steady.\");\n\n      vibrate(12);\n      await blip({ freq: 420, dur: 0.05, type: \"triangle\", gain: 0.04 });\n    };\n\n    const onDown = async (e) => {\n      if (state.completed) return;\n      // ensure audio context can start from gesture\n      await ensureAudioCtx();\n      state.aiming = true;\n      const r = canvas.getBoundingClientRect();\n      state.aimNow = { x: e.clientX - r.left, y: e.clientY - r.top };\n      vibrate(8);\n    };\n\n    const onMove = (e) => {\n      if (!state.aiming) return;\n      const r = canvas.getBoundingClientRect();\n      state.aimNow = { x: e.clientX - r.left, y: e.clientY - r.top };\n    };\n\n    const onUp = async () => {\n      if (!state.aiming) return;\n      state.aiming = false;\n      await shoot();\n    };\n\n    canvas.addEventListener(\"pointerdown\", onDown);\n    canvas.addEventListener(\"pointermove\", onMove);\n    canvas.addEventListener(\"pointerup\", onUp);\n    canvas.addEventListener(\"pointercancel\", onUp);\n\n    // Update loop\n    const update = async (dt, w, h) => {\n      // arrows\n      for (const a of state.arrows) {\n        if (!a.alive) continue;\n\n        // wind influences vx slightly\n        a.vx += state.wind * dt;\n        a.vy += config.gravity * dt;\n\n        a.x += a.vx * dt;\n        a.y += a.vy * dt;\n        a.rot = Math.atan2(a.vy, a.vx);\n\n        // kill if out of bounds\n        if (a.x > w + 120 || a.y > h + 120 || a.y < -180) a.alive = false;\n\n        // collisions\n        const arrowBox = { x: a.x, y: a.y, w: a.w, h: a.h };\n        for (const c of state.candles) {\n          if (!c.lit) continue;\n          const candleBox = { x: c.x, y: c.y, w: c.w, h: c.h };\n          if (rectsIntersect(arrowBox, candleBox)) {\n            c.lit = false;\n            c.wiggle = 1;\n            a.alive = false;\n            spawnSparks(c.x + c.w / 2, c.y);\n\n            vibrate([20, 20, 10]);\n            await blip({ freq: 820, dur: 0.06, type: \"sine\", gain: 0.06 });\n          }\n        }\n      }\n\n      // sparks\n      state.sparks = state.sparks.filter((p) => p.life > 0);\n      for (const p of state.sparks) {\n        p.vy = (p.vy ?? 0) + config.gravity * 0.35 * dt;\n        p.x += p.vx * dt;\n        p.y += p.vy * dt;\n        p.life -= dt;\n      }\n\n      // candle wiggle decay + flicker\n      for (const c of state.candles) {\n        if (c.wiggle > 0) c.wiggle = Math.max(0, c.wiggle - dt * 3);\n        c.flicker += dt * 18;\n      }\n\n      // completion\n      if (!state.completed && state.candles.every((c) => !c.lit)) {\n        state.completed = true;\n        setDone(true);\n        setHint(\"Perfect. Unlocked.\");\n\n        vibrate([30, 30, 30]);\n        await blip({ freq: 980, dur: 0.08, type: \"triangle\", gain: 0.06 });\n\n        if (typeof onComplete === \"function\") {\n          const timeMs = Math.max(0, performance.now() - startTimeRef.current);\n          onComplete({ shots: shots + 1, timeMs });\n        }\n      }\n    };\n\n    const drawBackground = (w, h) => {\n      // Dark base\n      ctx.clearRect(0, 0, w, h);\n\n      // Soft paper gradient (matches BirthdayCard feel)\n      const g = ctx.createLinearGradient(0, 0, 0, h);\n      g.addColorStop(0, \"rgba(15,18,22,1)\");\n      g.addColorStop(1, \"rgba(7,9,12,1)\");\n      ctx.fillStyle = g;\n      ctx.fillRect(0, 0, w, h);\n\n      // Warm + cool glows (like your poem panel)\n      const glow1 = ctx.createRadialGradient(w * 0.55, h * 0.18, 10, w * 0.55, h * 0.18, w * 0.9);\n      glow1.addColorStop(0, \"rgba(255,210,122,0.10)\");\n      glow1.addColorStop(1, \"rgba(255,210,122,0)\");\n      ctx.fillStyle = glow1;\n      ctx.fillRect(0, 0, w, h);\n\n      const glow2 = ctx.createRadialGradient(w * 0.18, h * 0.78, 10, w * 0.18, h * 0.78, w * 0.85);\n      glow2.addColorStop(0, \"rgba(190,240,255,0.10)\");\n      glow2.addColorStop(1, \"rgba(190,240,255,0)\");\n      ctx.fillStyle = glow2;\n      ctx.fillRect(0, 0, w, h);\n\n      // Subtle grain (cheap, effective)\n      ctx.globalAlpha = 0.14;\n      for (let i = 0; i < 220; i++) {\n        const x = Math.random() * w;\n        const y = Math.random() * h;\n        const r = Math.random() * 1.6;\n        ctx.fillStyle = Math.random() > 0.5 ? \"rgba(255,255,255,0.09)\" : \"rgba(0,0,0,0.10)\";\n        ctx.fillRect(x, y, r, r);\n      }\n      ctx.globalAlpha = 1;\n    };\n\n    const draw = (w, h) => {\n      drawBackground(w, h);\n\n      // ‚ÄúCake‚Äù platform line\n      ctx.strokeStyle = config.paperLine;\n      ctx.lineWidth = 1;\n      ctx.beginPath();\n      const cakeY = state.candles.length ? state.candles[0].y + state.candles[0].h + 16 : h * 0.62;\n      ctx.moveTo(w * 0.36, cakeY);\n      ctx.lineTo(w - 24, cakeY);\n      ctx.stroke();\n\n      // Wind indicator\n      ctx.font = \"12px system-ui, -apple-system, Segoe UI, Roboto, sans-serif\";\n      ctx.fillStyle = \"rgba(255,255,255,0.65)\";\n      const windDir = state.wind >= 0 ? \"‚Üí\" : \"‚Üê\";\n      ctx.fillText(`wind ${windDir}`, w - 74, 22);\n\n      // Candles + flames\n      for (const c of state.candles) {\n        const wiggleX = Math.sin((1 - c.wiggle) * 18) * 5 * c.wiggle;\n\n        // candle body (ink outline + warm fill)\n        ctx.fillStyle = \"rgba(255,255,255,0.06)\";\n        ctx.fillRect(c.x + wiggleX, c.y, c.w, c.h);\n\n        ctx.strokeStyle = \"rgba(255,255,255,0.10)\";\n        ctx.strokeRect(c.x + wiggleX, c.y, c.w, c.h);\n\n        if (c.lit) {\n          const fx = c.x + c.w / 2 + wiggleX + Math.sin(c.flicker) * 1.8;\n          const fy = c.y - 10 + Math.cos(c.flicker * 0.7) * 1.2;\n\n          // flame glow\n          const fg = ctx.createRadialGradient(fx, fy, 2, fx, fy, 16);\n          fg.addColorStop(0, \"rgba(255,210,122,0.55)\");\n          fg.addColorStop(1, \"rgba(255,210,122,0)\");\n          ctx.fillStyle = fg;\n          ctx.beginPath();\n          ctx.arc(fx, fy, 16, 0, Math.PI * 2);\n          ctx.fill();\n\n          // flame core\n          ctx.fillStyle = config.amber;\n          ctx.beginPath();\n          ctx.ellipse(fx, fy, 5.5, 10, 0, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      }\n\n      // Trajectory preview while aiming\n      if (state.aiming && !state.completed) {\n        const dx = state.origin.x - state.aimNow.x;\n        const dy = state.origin.y - state.aimNow.y;\n\n        let dist = Math.hypot(dx, dy) * 7.2;\n        dist = Math.max(config.minPower, Math.min(config.maxPower, dist));\n\n        const angle = Math.atan2(dy, dx);\n        let x = state.origin.x;\n        let y = state.origin.y;\n        let vx = Math.cos(angle) * dist;\n        let vy = Math.sin(angle) * dist;\n\n        ctx.fillStyle = config.inkSoft;\n        for (let i = 0; i < config.trailDots; i++) {\n          const dt = 0.016;\n          vx += state.wind * dt;\n          vy += config.gravity * dt;\n          x += vx * dt;\n          y += vy * dt;\n          ctx.fillRect(x, y, 2, 2);\n        }\n      }\n\n      // Bow (simple ink arc)\n      ctx.strokeStyle = config.inkSoft;\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n      ctx.arc(state.origin.x - 10, state.origin.y + 8, 42, -0.8, 0.8);\n      ctx.stroke();\n\n      // Arrows\n      for (const a of state.arrows) {\n        if (!a.alive) continue;\n        ctx.save();\n        ctx.translate(a.x, a.y);\n        ctx.rotate(a.rot);\n        ctx.fillStyle = config.ink;\n        ctx.fillRect(0, 0, a.w, a.h);\n\n        // tiny arrowhead\n        ctx.beginPath();\n        ctx.moveTo(a.w, a.h / 2);\n        ctx.lineTo(a.w + 8, -3);\n        ctx.lineTo(a.w + 8, a.h + 3);\n        ctx.closePath();\n        ctx.fill();\n\n        ctx.restore();\n      }\n\n      // Sparks\n      for (const p of state.sparks) {\n        ctx.globalAlpha = Math.max(0, p.life);\n        ctx.fillStyle = config.amber;\n        ctx.fillRect(p.x, p.y, p.size, p.size);\n        ctx.globalAlpha = 1;\n      }\n\n      // HUD (shots + hint)\n      ctx.fillStyle = \"rgba(255,255,255,0.70)\";\n      ctx.fillText(`shots ${shots}`, 14, 22);\n\n      ctx.fillStyle = \"rgba(255,255,255,0.75)\";\n      ctx.fillText(hint, 14, h - 14);\n    };\n\n    const loop = async (ts) => {\n      const dt = Math.min(0.033, (ts - state.lastTs) / 1000);\n      state.lastTs = ts;\n\n      state.w = canvas.clientWidth;\n      state.h = canvas.clientHeight;\n\n      if (!startTimeRef.current) startTimeRef.current = performance.now();\n\n      if (!state.completed) {\n        // update is async because of sound; keep it lightweight\n        await update(dt, state.w, state.h);\n      }\n\n      draw(state.w, state.h);\n\n      rafRef.current = requestAnimationFrame(loop);\n    };\n\n    rafRef.current = requestAnimationFrame(loop);\n\n    return () => {\n      window.removeEventListener(\"resize\", resize);\n      canvas.removeEventListener(\"pointerdown\", onDown);\n      canvas.removeEventListener(\"pointermove\", onMove);\n      canvas.removeEventListener(\"pointerup\", onUp);\n      canvas.removeEventListener(\"pointercancel\", onUp);\n      cancelAnimationFrame(rafRef.current);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [candleCount, height, config]);\n\n  return (\n    <div style={{ width: \"100%\", position: \"relative\" }}>\n      {showToggles && (\n        <div style={toggles}>\n          <button\n            type=\"button\"\n            onClick={() => setHapticsOn((v) => !v)}\n            style={{ ...toggleBtn, ...(hapticsOn ? toggleOn : {}) }}\n          >\n            Haptics {hapticsOn ? \"On\" : \"Off\"}\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setSoundOn((v) => !v)}\n            style={{ ...toggleBtn, ...(soundOn ? toggleOn : {}) }}\n          >\n            Sound {soundOn ? \"On\" : \"Off\"}\n          </button>\n        </div>\n      )}\n\n      <canvas\n        ref={canvasRef}\n        style={{\n          width: \"100%\",\n          height,\n          borderRadius: 18,\n          border: \"1px solid rgba(255,255,255,.10)\",\n          boxShadow: \"0 18px 40px rgba(0,0,0,.40)\",\n          touchAction: \"none\",\n        }}\n      />\n\n      {done && (\n        <div style={doneBadge}>\n          <div style={{ fontWeight: 900 }}>Unlocked</div>\n          <div style={{ fontSize: 12, opacity: 0.8 }}>Proceed to your reward.</div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst toggles = {\n  position: \"absolute\",\n  zIndex: 5,\n  top: 10,\n  left: 10,\n  display: \"flex\",\n  gap: 8,\n};\n\nconst toggleBtn = {\n  borderRadius: 999,\n  border: \"1px solid rgba(255,255,255,.14)\",\n  background: \"rgba(255,255,255,.06)\",\n  color: \"rgba(255,255,255,.85)\",\n  fontSize: 12,\n  padding: \"8px 10px\",\n  backdropFilter: \"blur(10px)\",\n};\n\nconst toggleOn = {\n  border: \"1px solid rgba(255,210,122,.35)\",\n  background: \"rgba(255,210,122,.10)\",\n  color: \"rgba(255,210,122,.95)\",\n};\n\nconst doneBadge = {\n  position: \"absolute\",\n  left: 14,\n  bottom: 14,\n  padding: \"10px 12px\",\n  borderRadius: 14,\n  border: \"1px solid rgba(255,210,122,.20)\",\n  background: \"rgba(0,0,0,.45)\",\n  color: \"rgba(255,210,122,.95)\",\n  backdropFilter: \"blur(10px)\",\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 658, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/BirthdayCard.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\n\n/**\n * BirthdayCard (Next.js / Vercel)\n * - Calligraphy font (TTF) rendered in SVG <text>\n * - \"Ink pressure\" via animated mask thickness (tapered ends, thick mid-line)\n * - Paper grain overlay + ink bleed filter\n * - Audio-synced writing driven by audio.currentTime\n * - Autoplay-safe: shows a \"Tap to start with sound\" overlay if blocked\n *\n * Assets (default):\n *  - Font:  /public/fonts/InterSignature-q20q2.ttf  -> /fonts/InterSignature-q20q2.ttf\n *  - Audio: /public/audio/luke-poem.mp3            -> /audio/luke-poem.mp3\n *  - Photos: /public/photo1.jpg etc.\n */\nexport default function BirthdayCard({\n  toName = \"Luke\",\n  photos = [\"/photo1.jpg\", \"/photo2.jpg\", \"/photo3.jpg\"],\n  fontUrl = \"/fonts/InterSignature-q20q2.ttf\",\n  audioUrl = \"/audio/luke-poem.mp3\",\n  autoStart = true,\n\n  /**\n   * lineStartTimes: seconds for each poem line (INCLUDING blank spacer lines).\n   * If you want perfect sync, tweak these by small amounts.\n   * If you pass null, it will auto-distribute across the audio duration.\n   */\n  lineStartTimes = [\n    0.000, 4.288, 7.407, 11.825, 15.464,\n    18.943, 23.189, 27.060, 31.680, 34.677,\n    36.994, 41.951, 45.941, 50.052, 53.196,\n    57.290, 62.135, 65.698, 69.403,\n  ],\n}) {\n  const POEM_LINES = useMemo(\n    () => [\n      \"The world became a brighter place\",\n      \"The moment Luke arrived,\",\n      \"With kindness written on your face\",\n      \"And a spirit meant to thrive\",\n      \"\",\n      \"Through every year and every mile,\",\n      \"You‚Äôve grown in heart and mind,\",\n      \"With a steady hand and a ready smile,\",\n      \"The rarest soul to find.\",\n      \"\",\n      \"May your day be filled with all you love,\",\n      \"With laughter, warmth, and light,\",\n      \"And may the year ahead hold dreams\",\n      \"That shine forever bright.\",\n      \"\",\n      \"So here‚Äôs to you, for all you are,\",\n      \"And all you‚Äôre yet to be‚Äî\",\n      \"Luke, you truly are a star\",\n      \"For everyone to see.\",\n    ],\n    []\n  );\n\n  const svgRef = useRef(null);\n  const penRef = useRef(null);\n  const audioRef = useRef(null);\n\n  // Animated mask: one path per line (white reveals the ink)\n  const maskPathsRef = useRef([]);\n  const rafRef = useRef(0);\n\n  const [status, setStatus] = useState(\"Ready ‚úçÔ∏è\");\n  const [ready, setReady] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [needsGesture, setNeedsGesture] = useState(false);\n\n  // Layout knobs\n  const viewW = 900;\n  const viewH = 560;\n  const startX = 40;\n  const startY = 90;\n  const lineGap = 48;\n  const maxRevealW = 860;\n\n  // Tuned \"pressure\" knobs\n  // Thinner starts/ends, richer mid-line, with a slightly late peak (feels more like a flourish)\n  const strokeMin = 18;   // thin\n  const strokeMax = 62;   // thick\n  const peakShift = 0.07; // shift thickness peak slightly later (0..0.15-ish)\n  const pressureGamma = 0.72; // <1 broadens the thick region\n\n  // Ink look\n  const inkFill = \"rgba(255,255,255,.96)\";\n  const inkGlow = \"rgba(255,210,122,.22)\";\n\n  // ---------- Font loading ----------\n  useEffect(() => {\n    let cancelled = false;\n    async function loadFont() {\n      try {\n        const ff = new FontFace(\"InterSignature\", `url(${fontUrl})`);\n        await ff.load();\n        document.fonts.add(ff);\n        await document.fonts.ready;\n      } catch {\n        // Fallback cursive is fine.\n      }\n      if (!cancelled) setReady(true);\n    }\n    loadFont();\n    return () => {\n      cancelled = true;\n    };\n  }, [fontUrl]);\n\n  // ---------- Build mask paths once ----------\n  useEffect(() => {\n    if (!ready) return;\n    const svg = svgRef.current;\n    if (!svg) return;\n\n    const maskGroup = svg.querySelector(\"#maskGroup\");\n    maskGroup.innerHTML = \"\";\n    maskPathsRef.current = [];\n\n    for (let i = 0; i < POEM_LINES.length; i++) {\n      const p = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n      p.setAttribute(\"fill\", \"white\");\n      p.setAttribute(\"d\", capsulePath(0, lineCenterY(i), i));\n      maskGroup.appendChild(p);\n      maskPathsRef.current.push(p);\n    }\n\n    if (penRef.current) {\n      penRef.current.style.opacity = \"0\";\n      penRef.current.style.transform = \"translate(-9999px,-9999px) rotate(18deg)\";\n    }\n  }, [ready, POEM_LINES]);\n\n  // ---------- Autostart (safe) ----------\n  useEffect(() => {\n    if (!ready || !autoStart) return;\n\n    const a = audioRef.current;\n    if (!a) return;\n\n    const onMeta = async () => {\n      try {\n        await a.play();\n        setNeedsGesture(false);\n        startSyncedAnimation();\n      } catch {\n        setNeedsGesture(true);\n        setStatus(\"Tap to start (sound permission)\");\n      }\n    };\n\n    a.addEventListener(\"loadedmetadata\", onMeta);\n    return () => a.removeEventListener(\"loadedmetadata\", onMeta);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ready, autoStart]);\n\n  // ---------- Helpers ----------\n  function stopRaf() {\n    if (rafRef.current) cancelAnimationFrame(rafRef.current);\n    rafRef.current = 0;\n  }\n\n  function clamp(v, a, b) {\n    return Math.max(a, Math.min(b, v));\n  }\n\n  function easeInOutCubic(x) {\n    return x < 0.5 ? 4 * x * x * x : 1 - Math.pow(-2 * x + 2, 3) / 2;\n  }\n\n  function hash01(n) {\n    // Deterministic pseudo-random (0..1) per line\n    const x = Math.sin(n * 999.123 + 0.123) * 10000;\n    return x - Math.floor(x);\n  }\n\n  function lineCenterY(i) {\n    return startY - 10 + i * lineGap;\n  }\n\n  function svgPointToPage(svg, x, y) {\n    const pt = svg.createSVGPoint();\n    pt.x = x;\n    pt.y = y;\n    return pt.matrixTransform(svg.getScreenCTM());\n  }\n\n  function computeAutoLineStarts(duration) {\n    const weights = POEM_LINES.map((l) => (l.trim() ? Math.max(6, l.length) : 4));\n    const total = weights.reduce((a, b) => a + b, 0);\n    let acc = 0;\n    return weights.map((w) => {\n      const t = (acc / total) * duration;\n      acc += w;\n      return t;\n    });\n  }\n\n  // ---------- Pressure-tuned mask path ----------\n  // progress: 0..1\n  // cy: center y for line band\n  // lineIndex: adds small per-line personality (pressure boost, nib wobble)\n  function capsulePath(progress, cy, lineIndex) {\n    const p = clamp(progress, 0, 1);\n    const pE = easeInOutCubic(p);\n\n    // Reveal length\n    const w = Math.max(0, maxRevealW * pE);\n    const x1 = startX + w;\n\n    // Per-line pressure personality\n    const rand = hash01(lineIndex + 1);\n    const line = POEM_LINES[lineIndex] ?? \"\";\n    const punctuationBoost = /[‚Äî‚Äì,.;:!?]$/.test(line.trim()) ? 1.06 : 1.0;\n    const lengthBoost = clamp(0.92 + (line.trim().length / 45) * 0.18, 0.92, 1.12);\n    const personality = (0.94 + rand * 0.12) * punctuationBoost * lengthBoost;\n\n    // Pressure curve (thickness): thin -> thick -> thin,\n    // with a slightly late peak to feel like a flourish.\n    const shifted = clamp(pE + peakShift, 0, 1);\n    const bell = Math.sin(Math.PI * shifted);\n    const broadBell = Math.pow(Math.max(0, bell), pressureGamma); // broaden mid region\n    const t = (strokeMin + (strokeMax - strokeMin) * broadBell) * personality;\n\n    // Taper ends a bit more (gives a nib-like lift)\n    const taper = 0.85 + 0.15 * Math.sin(Math.PI * pE);\n    const thickness = t * taper;\n\n    const r = thickness / 2;\n\n    // Ink wobble: subtle feathering feeling\n    const wobble = (Math.sin(pE * 10 + lineIndex) + Math.sin(pE * 23 + lineIndex * 2.3)) * 0.55;\n\n    const topY = cy - r + wobble;\n    const botY = cy + r + wobble;\n\n    // When nearly zero, show a dot-like nib kiss\n    if (w < 2) {\n      return `M ${startX} ${cy}\n              m -${r} 0\n              a ${r} ${r} 0 1 0 ${2 * r} 0\n              a ${r} ${r} 0 1 0 -${2 * r} 0`;\n    }\n\n    // Rounded capsule (pill)\n    return `\n      M ${startX} ${topY}\n      L ${x1} ${topY}\n      A ${r} ${r} 0 0 1 ${x1} ${botY}\n      L ${startX} ${botY}\n      A ${r} ${r} 0 0 1 ${startX} ${topY}\n      Z\n    `;\n  }\n\n  function findActiveLineIndex(tNow, starts, ends) {\n    for (let i = 0; i < starts.length; i++) {\n      if (tNow >= starts[i] && tNow < ends[i]) return i;\n    }\n    return -1;\n  }\n\n  // ---------- Animation driver (audio clock) ----------\n  function startSyncedAnimation() {\n    stopRaf();\n    const svg = svgRef.current;\n    const pen = penRef.current;\n    const audio = audioRef.current;\n    const paths = maskPathsRef.current;\n\n    if (!svg || !pen || !audio || !paths.length) return;\n\n    setIsPlaying(true);\n    setStatus(\"Writing‚Ä¶\");\n\n    const startsProvided =\n      Array.isArray(lineStartTimes) && lineStartTimes.length === POEM_LINES.length;\n\n    const starts = startsProvided\n      ? lineStartTimes\n      : computeAutoLineStarts(Number.isFinite(audio.duration) ? audio.duration : 72);\n\n    const duration = Number.isFinite(audio.duration) ? audio.duration : (starts[starts.length - 1] + 2);\n    const ends = starts.map((t, i) => (i < starts.length - 1 ? starts[i + 1] : duration));\n\n    const tick = () => {\n      const tNow = audio.currentTime;\n\n      // Update per-line progress\n      for (let i = 0; i < paths.length; i++) {\n        const line = POEM_LINES[i];\n        const t0 = starts[i];\n        const t1 = ends[i];\n\n        if (!line.trim()) {\n          const done = tNow >= t0 ? 1 : 0;\n          paths[i].setAttribute(\"d\", capsulePath(done, lineCenterY(i), i));\n          continue;\n        }\n\n        const p = clamp((tNow - t0) / Math.max(0.22, t1 - t0), 0, 1);\n        paths[i].setAttribute(\"d\", capsulePath(p, lineCenterY(i), i));\n      }\n\n      // Move pen to active line\n      const activeIndex = findActiveLineIndex(tNow, starts, ends);\n      if (activeIndex >= 0) {\n        const t0 = starts[activeIndex];\n        const t1 = ends[activeIndex];\n        const p = clamp((tNow - t0) / Math.max(0.22, t1 - t0), 0, 1);\n        const pE = easeInOutCubic(p);\n\n        pen.style.opacity = \"1\";\n\n        const nibWobble = (Math.sin(pE * 9 + activeIndex) + Math.sin(pE * 19)) * 1.1;\n        const px = startX + maxRevealW * pE + 10;\n        const py = startY + activeIndex * lineGap + nibWobble;\n\n        const page = svgPointToPage(svg, px, py);\n        pen.style.transform = `translate(${page.x - 9}px, ${page.y - 9}px) rotate(${18 + Math.sin(pE * 7) * 3}deg)`;\n      } else {\n        pen.style.opacity = \"0\";\n      }\n\n      if (audio.ended) {\n        setStatus(\"Done üíõ\");\n        setIsPlaying(false);\n        pen.style.opacity = \"0\";\n        stopRaf();\n        return;\n      }\n\n      rafRef.current = requestAnimationFrame(tick);\n    };\n\n    rafRef.current = requestAnimationFrame(tick);\n  }\n\n  async function handleStartFromOverlay() {\n    const a = audioRef.current;\n    if (!a) return;\n\n    try {\n      await a.play();\n      setNeedsGesture(false);\n      startSyncedAnimation();\n    } catch {\n      setStatus(\"Still blocked. Tap again or unmute.\");\n    }\n  }\n\n  function handlePlayPause() {\n    const a = audioRef.current;\n    if (!a) return;\n\n    if (a.paused) {\n      a.play()\n        .then(() => {\n          setNeedsGesture(false);\n          startSyncedAnimation();\n        })\n        .catch(() => {\n          setNeedsGesture(true);\n          setStatus(\"Tap to start (sound permission)\");\n        });\n    } else {\n      a.pause();\n      setIsPlaying(false);\n      setStatus(\"Paused\");\n      stopRaf();\n    }\n  }\n\n  function handleReplay() {\n    const a = audioRef.current;\n    if (!a) return;\n\n    a.pause();\n    a.currentTime = 0;\n    setStatus(\"Writing‚Ä¶\");\n    a.play()\n      .then(() => {\n        setNeedsGesture(false);\n        startSyncedAnimation();\n      })\n      .catch(() => {\n        setNeedsGesture(true);\n        setStatus(\"Tap to start (sound permission)\");\n      });\n  }\n\n  // ---------- Render ----------\n  return (\n    <div className=\"min-h-screen w-full grid place-items-center p-6\" style={{ color: \"white\" }}>\n      <div\n        className=\"w-full max-w-[980px] rounded-[22px] overflow-hidden\"\n        style={{\n          border: \"1px solid rgba(255,255,255,.10)\",\n          boxShadow: \"0 18px 60px rgba(0,0,0,.45)\",\n          background:\n            \"radial-gradient(1000px 600px at 15% 15%, rgba(158,231,255,.18), transparent 60%),\" +\n            \"radial-gradient(900px 650px at 85% 25%, rgba(255,210,122,.16), transparent 55%),\" +\n            \"radial-gradient(800px 600px at 60% 90%, rgba(206,166,255,.12), transparent 55%),\" +\n            \"linear-gradient(160deg, #0f1220, #1a1f35)\",\n        }}\n      >\n        {/* Header */}\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"space-between\",\n            gap: 12,\n            padding: \"16px 16px\",\n            borderBottom: \"1px solid rgba(255,255,255,.10)\",\n            backdropFilter: \"blur(10px)\",\n            background: \"linear-gradient(90deg, rgba(158,231,255,.10), rgba(255,210,122,.08))\",\n          }}\n        >\n          <div style={{ minWidth: 0 }}>\n            <div style={{ fontSize: 18, fontWeight: 800, whiteSpace: \"nowrap\", overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\n              Happy Birthday, {toName} üéâ\n            </div>\n            <div style={{ fontSize: 13, color: \"rgba(255,255,255,.70)\", whiteSpace: \"nowrap\", overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\n              Pressure ink + paper grain + synced narration.\n            </div>\n          </div>\n\n          <div style={{ display: \"flex\", gap: 10, flexWrap: \"wrap\", justifyContent: \"flex-end\" }}>\n            <button\n              onClick={handlePlayPause}\n              style={btnStyle(\"primary\")}\n              aria-label={isPlaying ? \"Pause\" : \"Play\"}\n            >\n              {isPlaying ? \"‚è∏ Pause\" : \"‚ñ∂ Play\"}\n            </button>\n            <button onClick={handleReplay} style={btnStyle()} aria-label=\"Replay\">\n              ‚Ü∫ Replay\n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div style={{ display: \"grid\", gridTemplateColumns: \"1fr 1.35fr\", minHeight: 580 }}>\n          {/* Left photos */}\n          <div\n            style={{\n              padding: 16,\n              borderRight: \"1px solid rgba(255,255,255,.10)\",\n              display: \"grid\",\n              placeItems: \"center\",\n              background:\n                \"radial-gradient(700px 450px at 30% 20%, rgba(255,210,122,.10), transparent 60%),\" +\n                \"radial-gradient(600px 400px at 75% 65%, rgba(158,231,255,.10), transparent 55%)\",\n            }}\n          >\n            <div style={{ position: \"relative\", width: \"92%\", maxWidth: 340, aspectRatio: \"4 / 5\" }}>\n              {photos.slice(0, 3).map((src, i) => {\n                const rot = [-6, 5, -2][i] ?? 0;\n                const tx = [-10, 10, 0][i] ?? 0;\n                const ty = [6, 0, -4][i] ?? 0;\n                const opacity = [1, 0.95, 0.92][i] ?? 1;\n                return (\n                  <div\n                    key={src + i}\n                    style={{\n                      position: \"absolute\",\n                      inset: 0,\n                      borderRadius: 18,\n                      overflow: \"hidden\",\n                      border: \"1px solid rgba(255,255,255,.15)\",\n                      boxShadow: \"0 14px 35px rgba(0,0,0,.35)\",\n                      background: \"rgba(255,255,255,.08)\",\n                      transform: `rotate(${rot}deg) translate(${tx}px, ${ty}px)`,\n                      transformOrigin: \"60% 80%\",\n                      opacity,\n                    }}\n                  >\n                    <img src={src} alt={`Photo ${i + 1}`} style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\", display: \"block\" }} />\n                    <div style={{ position: \"absolute\", left: 0, right: 0, bottom: 0, height: \"22%\", background: \"rgba(0,0,0,.35)\", borderTop: \"1px solid rgba(255,255,255,.10)\", backdropFilter: \"blur(6px)\" }} />\n                    <div style={{ position: \"absolute\", left: 12, right: 12, bottom: 10, fontSize: 12, display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", textShadow: \"0 2px 14px rgba(0,0,0,.60)\" }}>\n                      <span style={{ fontWeight: 800, color: \"rgba(255,210,122,.95)\" }}>Memory #{i + 1}</span>\n                      <span>‚ô°</span>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Right poem */}\n          <div style={{ padding: 16 }}>\n            <div\n              style={{\n                position: \"relative\",\n                height: \"100%\",\n                borderRadius: 18,\n                border: \"1px solid rgba(255,255,255,.10)\",\n                overflow: \"hidden\",\n                background:\n                  \"linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)),\" +\n                  \"radial-gradient(900px 600px at 50% 0%, rgba(255,210,122,.08), transparent 60%),\" +\n                  \"radial-gradient(700px 500px at 20% 80%, rgba(158,231,255,.08), transparent 55%)\",\n              }}\n            >\n              {/* Paper grain overlay */}\n              <div\n                style={{\n                  position: \"absolute\",\n                  inset: 0,\n                  pointerEvents: \"none\",\n                  opacity: 0.18,\n                  backgroundImage:\n                    \"radial-gradient(circle at 20% 30%, rgba(255,255,255,.35) 0 1px, transparent 2px),\" +\n                    \"radial-gradient(circle at 70% 60%, rgba(255,255,255,.28) 0 1px, transparent 2px),\" +\n                    \"radial-gradient(circle at 40% 80%, rgba(255,255,255,.22) 0 1px, transparent 2px)\",\n                  backgroundSize: \"120px 120px\",\n                  mixBlendMode: \"overlay\",\n                }}\n              />\n\n              <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"flex-end\", gap: 12, padding: \"18px 20px 0\", position: \"relative\" }}>\n                <div style={{ fontSize: 16, fontWeight: 800 }}>To {toName},</div>\n                <div style={{ fontSize: 12, color: \"rgba(255,255,255,.70)\", whiteSpace: \"nowrap\" }}>{status}</div>\n              </div>\n\n              <div\n                style={{\n                  margin: \"10px 20px 14px\",\n                  height: 1,\n                  opacity: 0.7,\n                  background: \"linear-gradient(90deg, rgba(255,210,122,.45), rgba(158,231,255,.35), transparent)\",\n                }}\n              />\n\n              <div style={{ padding: \"0 20px 64px\", position: \"relative\" }}>\n                <svg ref={svgRef} viewBox={`0 0 ${viewW} ${viewH}`} width=\"100%\" height=\"auto\" style={{ display: \"block\" }} aria-label=\"Poem\">\n                  <defs>\n                    <mask id=\"revealMask\">\n                      <rect x=\"0\" y=\"0\" width={viewW} height={viewH} fill=\"black\" />\n                      <g id=\"maskGroup\" />\n                    </mask>\n\n                    {/* Ink bleed: blurred underlayer */}\n                    <filter id=\"inkBleed\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\n                      <feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"0.95\" result=\"blur\" />\n                      <feColorMatrix\n                        in=\"blur\"\n                        type=\"matrix\"\n                        values=\"\n                          1 0 0 0 0\n                          0 1 0 0 0\n                          0 0 1 0 0\n                          0 0 0 0.45 0\"\n                        result=\"bleed\"\n                      />\n                      <feMerge>\n                        <feMergeNode in=\"bleed\" />\n                        <feMergeNode in=\"SourceGraphic\" />\n                      </feMerge>\n                    </filter>\n                  </defs>\n\n                  {/* Bleed underlayer */}\n                  <text\n                    x={startX}\n                    y={startY}\n                    mask=\"url(#revealMask)\"\n                    style={{\n                      fontFamily: `\"InterSignature\", cursive`,\n                      fontSize: 42,\n                      fill: \"rgba(255,255,255,.22)\",\n                      filter: \"url(#inkBleed)\",\n                    }}\n                  >\n                    {POEM_LINES.map((line, i) => (\n                      <tspan key={i} x={startX} y={startY + i * lineGap}>\n                        {line || \" \"}\n                      </tspan>\n                    ))}\n                  </text>\n\n                  {/* Main ink */}\n                  <text\n                    x={startX}\n                    y={startY}\n                    mask=\"url(#revealMask)\"\n                    style={{\n                      fontFamily: `\"InterSignature\", cursive`,\n                      fontSize: 42,\n                      fill: inkFill,\n                      filter: `drop-shadow(0 0 10px ${inkGlow})`,\n                    }}\n                  >\n                    {POEM_LINES.map((line, i) => (\n                      <tspan key={i} x={startX} y={startY + i * lineGap}>\n                        {line || \" \"}\n                      </tspan>\n                    ))}\n                  </text>\n                </svg>\n              </div>\n\n              {/* Pen nib */}\n              <div\n                ref={penRef}\n                style={{\n                  position: \"absolute\",\n                  width: 18,\n                  height: 18,\n                  borderRadius: 6,\n                  boxShadow: \"0 10px 24px rgba(0,0,0,.35)\",\n                  pointerEvents: \"none\",\n                  opacity: 0,\n                  background: \"linear-gradient(160deg, rgba(255,210,122,.9), rgba(158,231,255,.55))\",\n                  transform: \"translate(-9999px,-9999px) rotate(18deg)\",\n                }}\n              >\n                <div style={{ position: \"absolute\", left: 5, top: 5, width: 8, height: 8, borderRadius: 3, background: \"rgba(0,0,0,.55)\" }} />\n              </div>\n\n              {/* Audio */}\n              <audio ref={audioRef} src={audioUrl} preload=\"metadata\" />\n\n              {/* Autoplay overlay */}\n              {needsGesture && (\n                <button\n                  onClick={handleStartFromOverlay}\n                  style={{\n                    position: \"absolute\",\n                    inset: 0,\n                    display: \"grid\",\n                    placeItems: \"center\",\n                    background: \"rgba(0,0,0,.42)\",\n                    backdropFilter: \"blur(6px)\",\n                    border: \"none\",\n                    cursor: \"pointer\",\n                    color: \"white\",\n                  }}\n                >\n                  <span\n                    style={{\n                      padding: \"12px 18px\",\n                      borderRadius: 999,\n                      border: \"1px solid rgba(255,255,255,.25)\",\n                      background: \"rgba(255,255,255,.10)\",\n                      fontWeight: 900,\n                    }}\n                  >\n                    Tap to start with sound ‚ñ∂\n                  </span>\n                </button>\n              )}\n\n              <div style={{ position: \"absolute\", left: 18, right: 18, bottom: 14, fontSize: 12, color: \"rgba(255,255,255,.70)\", display: \"flex\", alignItems: \"center\", gap: 10, flexWrap: \"wrap\" }}>\n                <span\n                  style={{\n                    width: 10,\n                    height: 10,\n                    borderRadius: 999,\n                    background: \"rgba(255,210,122,.95)\",\n                    boxShadow: \"0 0 18px rgba(255,210,122,.65), 0 0 40px rgba(158,231,255,.22)\",\n                  }}\n                />\n                <span>Audio: {audioUrl}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Mobile stacking */}\n        <style>{`\n          @media (max-width: 860px) {\n            .stackGrid {\n              grid-template-columns: 1fr !important;\n            }\n          }\n        `}</style>\n      </div>\n    </div>\n  );\n}\n\nfunction btnStyle(kind) {\n  const base = {\n    appearance: \"none\",\n    borderRadius: 999,\n    padding: \"10px 12px\",\n    fontWeight: 900,\n    letterSpacing: \"0.2px\",\n    cursor: \"pointer\",\n    border: \"1px solid rgba(255,255,255,.16)\",\n    background: \"rgba(0,0,0,.20)\",\n    color: \"white\",\n    transition: \"transform .08s ease, background .2s ease, border-color .2s ease\",\n  };\n\n  if (kind === \"primary\") {\n    return {\n      ...base,\n      border: \"1px solid rgba(255,255,255,.20)\",\n      background: \"linear-gradient(90deg, rgba(255,210,122,.22), rgba(158,231,255,.18))\",\n    };\n  }\n\n  return base;\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAiBe,SAAS,aAAa,EACnC,SAAS,MAAM,EACf,SAAS;IAAC;IAAe;IAAe;CAAc,EACtD,UAAU,iCAAiC,EAC3C,WAAW,sBAAsB,EACjC,YAAY,IAAI,EAEhB;;;;GAIC,GACD,iBAAiB;IACf;IAAO;IAAO;IAAO;IAAQ;IAC7B;IAAQ;IAAQ;IAAQ;IAAQ;IAChC;IAAQ;IAAQ;IAAQ;IAAQ;IAChC;IAAQ;IAAQ;IAAQ;CACzB,EACF;;IACC,MAAM,aAAa,IAAA,wKAAO;4CACxB,IAAM;gBACJ;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;aACD;2CACD,EAAE;IAGJ,MAAM,SAAS,IAAA,uKAAM,EAAC;IACtB,MAAM,SAAS,IAAA,uKAAM,EAAC;IACtB,MAAM,WAAW,IAAA,uKAAM,EAAC;IAExB,2DAA2D;IAC3D,MAAM,eAAe,IAAA,uKAAM,EAAC,EAAE;IAC9B,MAAM,SAAS,IAAA,uKAAM,EAAC;IAEtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD,eAAe;IACf,MAAM,QAAQ;IACd,MAAM,QAAQ;IACd,MAAM,SAAS;IACf,MAAM,SAAS;IACf,MAAM,UAAU;IAChB,MAAM,aAAa;IAEnB,yBAAyB;IACzB,+FAA+F;IAC/F,MAAM,YAAY,IAAM,OAAO;IAC/B,MAAM,YAAY,IAAM,QAAQ;IAChC,MAAM,YAAY,MAAM,oDAAoD;IAC5E,MAAM,gBAAgB,MAAM,+BAA+B;IAE3D,WAAW;IACX,MAAM,UAAU;IAChB,MAAM,UAAU;IAEhB,qCAAqC;IACrC,IAAA,0KAAS;kCAAC;YACR,IAAI,YAAY;YAChB,eAAe;gBACb,IAAI;oBACF,MAAM,KAAK,IAAI,SAAS,kBAAkB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;oBAC3D,MAAM,GAAG,IAAI;oBACb,SAAS,KAAK,CAAC,GAAG,CAAC;oBACnB,MAAM,SAAS,KAAK,CAAC,KAAK;gBAC5B,EAAE,OAAM;gBACN,4BAA4B;gBAC9B;gBACA,IAAI,CAAC,WAAW,SAAS;YAC3B;YACA;YACA;0CAAO;oBACL,YAAY;gBACd;;QACF;iCAAG;QAAC;KAAQ;IAEZ,8CAA8C;IAC9C,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,OAAO;YACZ,MAAM,MAAM,OAAO,OAAO;YAC1B,IAAI,CAAC,KAAK;YAEV,MAAM,YAAY,IAAI,aAAa,CAAC;YACpC,UAAU,SAAS,GAAG;YACtB,aAAa,OAAO,GAAG,EAAE;YAEzB,IAAK,IAAI,IAAI,GAAG,IAAI,WAAW,MAAM,EAAE,IAAK;gBAC1C,MAAM,IAAI,SAAS,eAAe,CAAC,8BAA8B;gBACjE,EAAE,YAAY,CAAC,QAAQ;gBACvB,EAAE,YAAY,CAAC,KAAK,YAAY,GAAG,YAAY,IAAI;gBACnD,UAAU,WAAW,CAAC;gBACtB,aAAa,OAAO,CAAC,IAAI,CAAC;YAC5B;YAEA,IAAI,OAAO,OAAO,EAAE;gBAClB,OAAO,OAAO,CAAC,KAAK,CAAC,OAAO,GAAG;gBAC/B,OAAO,OAAO,CAAC,KAAK,CAAC,SAAS,GAAG;YACnC;QACF;iCAAG;QAAC;QAAO;KAAW;IAEtB,yCAAyC;IACzC,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,SAAS,CAAC,WAAW;YAE1B,MAAM,IAAI,SAAS,OAAO;YAC1B,IAAI,CAAC,GAAG;YAER,MAAM;iDAAS;oBACb,IAAI;wBACF,MAAM,EAAE,IAAI;wBACZ,gBAAgB;wBAChB;oBACF,EAAE,OAAM;wBACN,gBAAgB;wBAChB,UAAU;oBACZ;gBACF;;YAEA,EAAE,gBAAgB,CAAC,kBAAkB;YACrC;0CAAO,IAAM,EAAE,mBAAmB,CAAC,kBAAkB;;QACrD,uDAAuD;QACzD;iCAAG;QAAC;QAAO;KAAU;IAErB,gCAAgC;IAChC,SAAS;QACP,IAAI,OAAO,OAAO,EAAE,qBAAqB,OAAO,OAAO;QACvD,OAAO,OAAO,GAAG;IACnB;IAEA,SAAS,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC;QACpB,OAAO,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG;IACjC;IAEA,SAAS,eAAe,CAAC;QACvB,OAAO,IAAI,MAAM,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,GAAG,CAAC,CAAC,IAAI,IAAI,GAAG,KAAK;IACjE;IAEA,SAAS,OAAO,CAAC;QACf,8CAA8C;QAC9C,MAAM,IAAI,KAAK,GAAG,CAAC,IAAI,UAAU,SAAS;QAC1C,OAAO,IAAI,KAAK,KAAK,CAAC;IACxB;IAEA,SAAS,YAAY,CAAC;QACpB,OAAO,SAAS,KAAK,IAAI;IAC3B;IAEA,SAAS,eAAe,GAAG,EAAE,CAAC,EAAE,CAAC;QAC/B,MAAM,KAAK,IAAI,cAAc;QAC7B,GAAG,CAAC,GAAG;QACP,GAAG,CAAC,GAAG;QACP,OAAO,GAAG,eAAe,CAAC,IAAI,YAAY;IAC5C;IAEA,SAAS,sBAAsB,QAAQ;QACrC,MAAM,UAAU,WAAW,GAAG,CAAC,CAAC,IAAO,EAAE,IAAI,KAAK,KAAK,GAAG,CAAC,GAAG,EAAE,MAAM,IAAI;QAC1E,MAAM,QAAQ,QAAQ,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,GAAG;QAC9C,IAAI,MAAM;QACV,OAAO,QAAQ,GAAG,CAAC,CAAC;YAClB,MAAM,IAAI,AAAC,MAAM,QAAS;YAC1B,OAAO;YACP,OAAO;QACT;IACF;IAEA,iDAAiD;IACjD,iBAAiB;IACjB,6BAA6B;IAC7B,0EAA0E;IAC1E,SAAS,YAAY,QAAQ,EAAE,EAAE,EAAE,SAAS;QAC1C,MAAM,IAAI,MAAM,UAAU,GAAG;QAC7B,MAAM,KAAK,eAAe;QAE1B,gBAAgB;QAChB,MAAM,IAAI,KAAK,GAAG,CAAC,GAAG,aAAa;QACnC,MAAM,KAAK,SAAS;QAEpB,gCAAgC;QAChC,MAAM,OAAO,OAAO,YAAY;QAChC,MAAM,OAAO,UAAU,CAAC,UAAU,IAAI;QACtC,MAAM,mBAAmB,cAAc,IAAI,CAAC,KAAK,IAAI,MAAM,OAAO;QAClE,MAAM,cAAc,MAAM,OAAO,AAAC,KAAK,IAAI,GAAG,MAAM,GAAG,KAAM,MAAM,MAAM;QACzE,MAAM,cAAc,CAAC,OAAO,OAAO,IAAI,IAAI,mBAAmB;QAE9D,qDAAqD;QACrD,qDAAqD;QACrD,MAAM,UAAU,MAAM,KAAK,WAAW,GAAG;QACzC,MAAM,OAAO,KAAK,GAAG,CAAC,KAAK,EAAE,GAAG;QAChC,MAAM,YAAY,KAAK,GAAG,CAAC,KAAK,GAAG,CAAC,GAAG,OAAO,gBAAgB,qBAAqB;QACnF,MAAM,IAAI,CAAC,YAAY,CAAC,YAAY,SAAS,IAAI,SAAS,IAAI;QAE9D,gDAAgD;QAChD,MAAM,QAAQ,OAAO,OAAO,KAAK,GAAG,CAAC,KAAK,EAAE,GAAG;QAC/C,MAAM,YAAY,IAAI;QAEtB,MAAM,IAAI,YAAY;QAEtB,wCAAwC;QACxC,MAAM,SAAS,CAAC,KAAK,GAAG,CAAC,KAAK,KAAK,aAAa,KAAK,GAAG,CAAC,KAAK,KAAK,YAAY,IAAI,IAAI;QAEvF,MAAM,OAAO,KAAK,IAAI;QACtB,MAAM,OAAO,KAAK,IAAI;QAEtB,6CAA6C;QAC7C,IAAI,IAAI,GAAG;YACT,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,EAAE,GAAG;iBACd,EAAE,EAAE;gBACL,EAAE,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;gBACxB,EAAE,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,EAAE,CAAC;QACxC;QAEA,yBAAyB;QACzB,OAAO,CAAC;QACJ,EAAE,OAAO,CAAC,EAAE,KAAK;QACjB,EAAE,GAAG,CAAC,EAAE,KAAK;QACb,EAAE,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,GAAG,CAAC,EAAE,KAAK;QAC7B,EAAE,OAAO,CAAC,EAAE,KAAK;QACjB,EAAE,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,KAAK;;IAErC,CAAC;IACH;IAEA,SAAS,oBAAoB,IAAI,EAAE,MAAM,EAAE,IAAI;QAC7C,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;YACtC,IAAI,QAAQ,MAAM,CAAC,EAAE,IAAI,OAAO,IAAI,CAAC,EAAE,EAAE,OAAO;QAClD;QACA,OAAO,CAAC;IACV;IAEA,uDAAuD;IACvD,SAAS;QACP;QACA,MAAM,MAAM,OAAO,OAAO;QAC1B,MAAM,MAAM,OAAO,OAAO;QAC1B,MAAM,QAAQ,SAAS,OAAO;QAC9B,MAAM,QAAQ,aAAa,OAAO;QAElC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,MAAM,EAAE;QAE7C,aAAa;QACb,UAAU;QAEV,MAAM,iBACJ,MAAM,OAAO,CAAC,mBAAmB,eAAe,MAAM,KAAK,WAAW,MAAM;QAE9E,MAAM,SAAS,iBACX,iBACA,sBAAsB,OAAO,QAAQ,CAAC,MAAM,QAAQ,IAAI,MAAM,QAAQ,GAAG;QAE7E,MAAM,WAAW,OAAO,QAAQ,CAAC,MAAM,QAAQ,IAAI,MAAM,QAAQ,GAAI,MAAM,CAAC,OAAO,MAAM,GAAG,EAAE,GAAG;QACjG,MAAM,OAAO,OAAO,GAAG,CAAC,CAAC,GAAG,IAAO,IAAI,OAAO,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,EAAE,GAAG;QAE3E,MAAM,OAAO;YACX,MAAM,OAAO,MAAM,WAAW;YAE9B,2BAA2B;YAC3B,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAAK;gBACrC,MAAM,OAAO,UAAU,CAAC,EAAE;gBAC1B,MAAM,KAAK,MAAM,CAAC,EAAE;gBACpB,MAAM,KAAK,IAAI,CAAC,EAAE;gBAElB,IAAI,CAAC,KAAK,IAAI,IAAI;oBAChB,MAAM,OAAO,QAAQ,KAAK,IAAI;oBAC9B,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,KAAK,YAAY,MAAM,YAAY,IAAI;oBAC7D;gBACF;gBAEA,MAAM,IAAI,MAAM,CAAC,OAAO,EAAE,IAAI,KAAK,GAAG,CAAC,MAAM,KAAK,KAAK,GAAG;gBAC1D,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,KAAK,YAAY,GAAG,YAAY,IAAI;YAC5D;YAEA,0BAA0B;YAC1B,MAAM,cAAc,oBAAoB,MAAM,QAAQ;YACtD,IAAI,eAAe,GAAG;gBACpB,MAAM,KAAK,MAAM,CAAC,YAAY;gBAC9B,MAAM,KAAK,IAAI,CAAC,YAAY;gBAC5B,MAAM,IAAI,MAAM,CAAC,OAAO,EAAE,IAAI,KAAK,GAAG,CAAC,MAAM,KAAK,KAAK,GAAG;gBAC1D,MAAM,KAAK,eAAe;gBAE1B,IAAI,KAAK,CAAC,OAAO,GAAG;gBAEpB,MAAM,YAAY,CAAC,KAAK,GAAG,CAAC,KAAK,IAAI,eAAe,KAAK,GAAG,CAAC,KAAK,GAAG,IAAI;gBACzE,MAAM,KAAK,SAAS,aAAa,KAAK;gBACtC,MAAM,KAAK,SAAS,cAAc,UAAU;gBAE5C,MAAM,OAAO,eAAe,KAAK,IAAI;gBACrC,IAAI,KAAK,CAAC,SAAS,GAAG,CAAC,UAAU,EAAE,KAAK,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,CAAC,GAAG,EAAE,WAAW,EAAE,KAAK,KAAK,GAAG,CAAC,KAAK,KAAK,EAAE,IAAI,CAAC;YAC7G,OAAO;gBACL,IAAI,KAAK,CAAC,OAAO,GAAG;YACtB;YAEA,IAAI,MAAM,KAAK,EAAE;gBACf,UAAU;gBACV,aAAa;gBACb,IAAI,KAAK,CAAC,OAAO,GAAG;gBACpB;gBACA;YACF;YAEA,OAAO,OAAO,GAAG,sBAAsB;QACzC;QAEA,OAAO,OAAO,GAAG,sBAAsB;IACzC;IAEA,eAAe;QACb,MAAM,IAAI,SAAS,OAAO;QAC1B,IAAI,CAAC,GAAG;QAER,IAAI;YACF,MAAM,EAAE,IAAI;YACZ,gBAAgB;YAChB;QACF,EAAE,OAAM;YACN,UAAU;QACZ;IACF;IAEA,SAAS;QACP,MAAM,IAAI,SAAS,OAAO;QAC1B,IAAI,CAAC,GAAG;QAER,IAAI,EAAE,MAAM,EAAE;YACZ,EAAE,IAAI,GACH,IAAI,CAAC;gBACJ,gBAAgB;gBAChB;YACF,GACC,KAAK,CAAC;gBACL,gBAAgB;gBAChB,UAAU;YACZ;QACJ,OAAO;YACL,EAAE,KAAK;YACP,aAAa;YACb,UAAU;YACV;QACF;IACF;IAEA,SAAS;QACP,MAAM,IAAI,SAAS,OAAO;QAC1B,IAAI,CAAC,GAAG;QAER,EAAE,KAAK;QACP,EAAE,WAAW,GAAG;QAChB,UAAU;QACV,EAAE,IAAI,GACH,IAAI,CAAC;YACJ,gBAAgB;YAChB;QACF,GACC,KAAK,CAAC;YACL,gBAAgB;YAChB,UAAU;QACZ;IACJ;IAEA,+BAA+B;IAC/B,qBACE,6LAAC;QAAI,WAAU;QAAkD,OAAO;YAAE,OAAO;QAAQ;kBACvF,cAAA,6LAAC;YACC,WAAU;YACV,OAAO;gBACL,QAAQ;gBACR,WAAW;gBACX,YACE,sFACA,qFACA,qFACA;YACJ;;8BAGA,6LAAC;oBACC,OAAO;wBACL,SAAS;wBACT,YAAY;wBACZ,gBAAgB;wBAChB,KAAK;wBACL,SAAS;wBACT,cAAc;wBACd,gBAAgB;wBAChB,YAAY;oBACd;;sCAEA,6LAAC;4BAAI,OAAO;gCAAE,UAAU;4BAAE;;8CACxB,6LAAC;oCAAI,OAAO;wCAAE,UAAU;wCAAI,YAAY;wCAAK,YAAY;wCAAU,UAAU;wCAAU,cAAc;oCAAW;;wCAAG;wCAChG;wCAAO;;;;;;;8CAE1B,6LAAC;oCAAI,OAAO;wCAAE,UAAU;wCAAI,OAAO;wCAAyB,YAAY;wCAAU,UAAU;wCAAU,cAAc;oCAAW;8CAAG;;;;;;;;;;;;sCAKpI,6LAAC;4BAAI,OAAO;gCAAE,SAAS;gCAAQ,KAAK;gCAAI,UAAU;gCAAQ,gBAAgB;4BAAW;;8CACnF,6LAAC;oCACC,SAAS;oCACT,OAAO,SAAS;oCAChB,cAAY,YAAY,UAAU;8CAEjC,YAAY,YAAY;;;;;;8CAE3B,6LAAC;oCAAO,SAAS;oCAAc,OAAO;oCAAY,cAAW;8CAAS;;;;;;;;;;;;;;;;;;8BAO1E,6LAAC;oBAAI,OAAO;wBAAE,SAAS;wBAAQ,qBAAqB;wBAAc,WAAW;oBAAI;;sCAE/E,6LAAC;4BACC,OAAO;gCACL,SAAS;gCACT,aAAa;gCACb,SAAS;gCACT,YAAY;gCACZ,YACE,qFACA;4BACJ;sCAEA,cAAA,6LAAC;gCAAI,OAAO;oCAAE,UAAU;oCAAY,OAAO;oCAAO,UAAU;oCAAK,aAAa;gCAAQ;0CACnF,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK;oCAC5B,MAAM,MAAM;wCAAC,CAAC;wCAAG;wCAAG,CAAC;qCAAE,CAAC,EAAE,IAAI;oCAC9B,MAAM,KAAK;wCAAC,CAAC;wCAAI;wCAAI;qCAAE,CAAC,EAAE,IAAI;oCAC9B,MAAM,KAAK;wCAAC;wCAAG;wCAAG,CAAC;qCAAE,CAAC,EAAE,IAAI;oCAC5B,MAAM,UAAU;wCAAC;wCAAG;wCAAM;qCAAK,CAAC,EAAE,IAAI;oCACtC,qBACE,6LAAC;wCAEC,OAAO;4CACL,UAAU;4CACV,OAAO;4CACP,cAAc;4CACd,UAAU;4CACV,QAAQ;4CACR,WAAW;4CACX,YAAY;4CACZ,WAAW,CAAC,OAAO,EAAE,IAAI,eAAe,EAAE,GAAG,IAAI,EAAE,GAAG,GAAG,CAAC;4CAC1D,iBAAiB;4CACjB;wCACF;;0DAEA,6LAAC;gDAAI,KAAK;gDAAK,KAAK,CAAC,MAAM,EAAE,IAAI,GAAG;gDAAE,OAAO;oDAAE,OAAO;oDAAQ,QAAQ;oDAAQ,WAAW;oDAAS,SAAS;gDAAQ;;;;;;0DACnH,6LAAC;gDAAI,OAAO;oDAAE,UAAU;oDAAY,MAAM;oDAAG,OAAO;oDAAG,QAAQ;oDAAG,QAAQ;oDAAO,YAAY;oDAAmB,WAAW;oDAAmC,gBAAgB;gDAAY;;;;;;0DAC1L,6LAAC;gDAAI,OAAO;oDAAE,UAAU;oDAAY,MAAM;oDAAI,OAAO;oDAAI,QAAQ;oDAAI,UAAU;oDAAI,SAAS;oDAAQ,gBAAgB;oDAAiB,YAAY;oDAAU,YAAY;gDAA6B;;kEAClM,6LAAC;wDAAK,OAAO;4DAAE,YAAY;4DAAK,OAAO;wDAAwB;;4DAAG;4DAAS,IAAI;;;;;;;kEAC/E,6LAAC;kEAAK;;;;;;;;;;;;;uCAlBH,MAAM;;;;;gCAsBjB;;;;;;;;;;;sCAKJ,6LAAC;4BAAI,OAAO;gCAAE,SAAS;4BAAG;sCACxB,cAAA,6LAAC;gCACC,OAAO;oCACL,UAAU;oCACV,QAAQ;oCACR,cAAc;oCACd,QAAQ;oCACR,UAAU;oCACV,YACE,2EACA,oFACA;gCACJ;;kDAGA,6LAAC;wCACC,OAAO;4CACL,UAAU;4CACV,OAAO;4CACP,eAAe;4CACf,SAAS;4CACT,iBACE,sFACA,sFACA;4CACF,gBAAgB;4CAChB,cAAc;wCAChB;;;;;;kDAGF,6LAAC;wCAAI,OAAO;4CAAE,SAAS;4CAAQ,gBAAgB;4CAAiB,YAAY;4CAAY,KAAK;4CAAI,SAAS;4CAAe,UAAU;wCAAW;;0DAC5I,6LAAC;gDAAI,OAAO;oDAAE,UAAU;oDAAI,YAAY;gDAAI;;oDAAG;oDAAI;oDAAO;;;;;;;0DAC1D,6LAAC;gDAAI,OAAO;oDAAE,UAAU;oDAAI,OAAO;oDAAyB,YAAY;gDAAS;0DAAI;;;;;;;;;;;;kDAGvF,6LAAC;wCACC,OAAO;4CACL,QAAQ;4CACR,QAAQ;4CACR,SAAS;4CACT,YAAY;wCACd;;;;;;kDAGF,6LAAC;wCAAI,OAAO;4CAAE,SAAS;4CAAe,UAAU;wCAAW;kDACzD,cAAA,6LAAC;4CAAI,KAAK;4CAAQ,SAAS,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,OAAO;4CAAE,OAAM;4CAAO,QAAO;4CAAO,OAAO;gDAAE,SAAS;4CAAQ;4CAAG,cAAW;;8DACrH,6LAAC;;sEACC,6LAAC;4DAAK,IAAG;;8EACP,6LAAC;oEAAK,GAAE;oEAAI,GAAE;oEAAI,OAAO;oEAAO,QAAQ;oEAAO,MAAK;;;;;;8EACpD,6LAAC;oEAAE,IAAG;;;;;;;;;;;;sEAIR,6LAAC;4DAAO,IAAG;4DAAW,GAAE;4DAAO,GAAE;4DAAO,OAAM;4DAAO,QAAO;;8EAC1D,6LAAC;oEAAe,IAAG;oEAAgB,cAAa;oEAAO,QAAO;;;;;;8EAC9D,6LAAC;oEACC,IAAG;oEACH,MAAK;oEACL,QAAO;oEAKP,QAAO;;;;;;8EAET,6LAAC;;sFACC,6LAAC;4EAAY,IAAG;;;;;;sFAChB,6LAAC;4EAAY,IAAG;;;;;;;;;;;;;;;;;;;;;;;;8DAMtB,6LAAC;oDACC,GAAG;oDACH,GAAG;oDACH,MAAK;oDACL,OAAO;wDACL,YAAY,CAAC,yBAAyB,CAAC;wDACvC,UAAU;wDACV,MAAM;wDACN,QAAQ;oDACV;8DAEC,WAAW,GAAG,CAAC,CAAC,MAAM,kBACrB,6LAAC;4DAAc,GAAG;4DAAQ,GAAG,SAAS,IAAI;sEACvC,QAAQ;2DADC;;;;;;;;;;8DAOhB,6LAAC;oDACC,GAAG;oDACH,GAAG;oDACH,MAAK;oDACL,OAAO;wDACL,YAAY,CAAC,yBAAyB,CAAC;wDACvC,UAAU;wDACV,MAAM;wDACN,QAAQ,CAAC,qBAAqB,EAAE,QAAQ,CAAC,CAAC;oDAC5C;8DAEC,WAAW,GAAG,CAAC,CAAC,MAAM,kBACrB,6LAAC;4DAAc,GAAG;4DAAQ,GAAG,SAAS,IAAI;sEACvC,QAAQ;2DADC;;;;;;;;;;;;;;;;;;;;;kDASpB,6LAAC;wCACC,KAAK;wCACL,OAAO;4CACL,UAAU;4CACV,OAAO;4CACP,QAAQ;4CACR,cAAc;4CACd,WAAW;4CACX,eAAe;4CACf,SAAS;4CACT,YAAY;4CACZ,WAAW;wCACb;kDAEA,cAAA,6LAAC;4CAAI,OAAO;gDAAE,UAAU;gDAAY,MAAM;gDAAG,KAAK;gDAAG,OAAO;gDAAG,QAAQ;gDAAG,cAAc;gDAAG,YAAY;4CAAkB;;;;;;;;;;;kDAI3H,6LAAC;wCAAM,KAAK;wCAAU,KAAK;wCAAU,SAAQ;;;;;;oCAG5C,8BACC,6LAAC;wCACC,SAAS;wCACT,OAAO;4CACL,UAAU;4CACV,OAAO;4CACP,SAAS;4CACT,YAAY;4CACZ,YAAY;4CACZ,gBAAgB;4CAChB,QAAQ;4CACR,QAAQ;4CACR,OAAO;wCACT;kDAEA,cAAA,6LAAC;4CACC,OAAO;gDACL,SAAS;gDACT,cAAc;gDACd,QAAQ;gDACR,YAAY;gDACZ,YAAY;4CACd;sDACD;;;;;;;;;;;kDAML,6LAAC;wCAAI,OAAO;4CAAE,UAAU;4CAAY,MAAM;4CAAI,OAAO;4CAAI,QAAQ;4CAAI,UAAU;4CAAI,OAAO;4CAAyB,SAAS;4CAAQ,YAAY;4CAAU,KAAK;4CAAI,UAAU;wCAAO;;0DAClL,6LAAC;gDACC,OAAO;oDACL,OAAO;oDACP,QAAQ;oDACR,cAAc;oDACd,YAAY;oDACZ,WAAW;gDACb;;;;;;0DAEF,6LAAC;;oDAAK;oDAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAOtB,6LAAC;8BAAO,CAAC;;;;;;QAMT,CAAC;;;;;;;;;;;;;;;;;AAIT;GA5pBwB;KAAA;AA8pBxB,SAAS,SAAS,IAAI;IACpB,MAAM,OAAO;QACX,YAAY;QACZ,cAAc;QACd,SAAS;QACT,YAAY;QACZ,eAAe;QACf,QAAQ;QACR,QAAQ;QACR,YAAY;QACZ,OAAO;QACP,YAAY;IACd;IAEA,IAAI,SAAS,WAAW;QACtB,OAAO;YACL,GAAG,IAAI;YACP,QAAQ;YACR,YAAY;QACd;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 1704, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/page.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useMemo, useState } from \"react\";\nimport ArcheryGame from \"./components/ArcheryGame\";\nimport BirthdayCard from \"./components/BirthdayCard\";\n\nexport default function Page() {\n  const [step, setStep] = useState(\"archery\"); // \"archery\" | \"earned\" | \"poem\"\n  const [result, setResult] = useState({ shots: null, timeMs: null });\n\n  const earnedCopy = useMemo(() => {\n    // Light ‚Äúearned‚Äù framing: performance -> praise -> permission -> poem\n    return {\n      title: \"You earned what comes next.\",\n      stats: [\n        [\"Strength\", \"‚ñ≤\"],\n        [\"Discipline\", \"‚ñ≤\"],\n        [\"Focus\", \"‚ñ≤\"],\n        [\"Good boy energy\", \"MAXED\"],\n      ],\n      agentLines: [\n        \"BirthdayAgent v1.0\",\n        \"Status: ONLINE\",\n        \"\",\n        \"‚úì Candles extinguished\",\n        \"‚úì Form verified\",\n        \"‚úì Reward authorized\",\n      ],\n    };\n  }, []);\n\n  return (\n    <div style={shell}>\n      <div style={chrome}>\n        <div style={brand}>LUKE MODE</div>\n        <div style={sub}>Mobile-first birthday quest</div>\n      </div>\n\n      {step === \"archery\" && (\n        <div style={{ width: \"100%\" }}>\n          <div style={headerBlock}>\n            <div style={kicker}>Step 1</div>\n            <h1 style={h1}>Extinguish the candles.</h1>\n            <p style={p}>\n              Drag to aim. Release to shoot. Precision first.\n            </p>\n          </div>\n\n          <ArcheryGame\n            candleCount={7}\n            height={420}\n            onComplete={({ shots, timeMs }) => {\n              setResult({ shots, timeMs });\n              setStep(\"earned\");\n            }}\n          />\n        </div>\n      )}\n\n      {step === \"earned\" && (\n        <div style={earnedWrap}>\n          <div style={card}>\n            <div style={kicker}>Unlocked</div>\n            <h1 style={{ ...h1, marginTop: 6 }}>{earnedCopy.title}</h1>\n\n            <div style={statGrid}>\n              {earnedCopy.stats.map(([k, v]) => (\n                <div key={k} style={statItem}>\n                  <div style={statKey}>{k}</div>\n                  <div style={statVal}>{v}</div>\n                </div>\n              ))}\n            </div>\n\n            <div style={tinyRow}>\n              <div style={pill}>Shots: {result.shots ?? \"‚Äî\"}</div>\n              <div style={pill}>\n                Time:{\" \"}\n                {result.timeMs == null ? \"‚Äî\" : `${Math.round(result.timeMs / 1000)}s`}\n              </div>\n            </div>\n\n            <div style={terminal}>\n              {earnedCopy.agentLines.map((ln, i) => (\n                <div key={i} style={{ whiteSpace: \"pre-wrap\" }}>\n                  {ln}\n                </div>\n              ))}\n            </div>\n\n            <button style={primaryBtn} onClick={() => setStep(\"poem\")}>\n              Continue\n            </button>\n\n            <div style={finePrint}>\n              Tip: tap play if your phone blocks auto-audio.\n            </div>\n          </div>\n        </div>\n      )}\n\n      {step === \"poem\" && (\n        <div style={{ width: \"100%\" }}>\n          <BirthdayCard\n            toName=\"Luke\"\n            photos={[\"/photo1.jpg\", \"/photo2.jpg\", \"/photo3.jpg\"]}\n            fontUrl=\"/fonts/InterSignature-q20q2.ttf\"\n            audioUrl=\"/audio/luke-poem.mp3\"\n            autoStart={true}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst shell = {\n  minHeight: \"100dvh\",\n  padding: \"18px 14px 32px\",\n  color: \"white\",\n  background:\n    \"radial-gradient(120% 120% at 50% 0%, rgba(255,210,122,.14), rgba(0,0,0,.92))\",\n};\n\nconst chrome = {\n  width: \"100%\",\n  maxWidth: 980,\n  margin: \"0 auto 10px\",\n  display: \"flex\",\n  alignItems: \"baseline\",\n  justifyContent: \"space-between\",\n  gap: 12,\n};\n\nconst brand = {\n  fontWeight: 950,\n  letterSpacing: \"0.9px\",\n  opacity: 0.9,\n};\n\nconst sub = {\n  opacity: 0.65,\n  fontSize: 13,\n};\n\nconst headerBlock = {\n  width: \"100%\",\n  maxWidth: 980,\n  margin: \"0 auto 10px\",\n  padding: \"10px 6px 6px\",\n};\n\nconst kicker = {\n  fontWeight: 900,\n  letterSpacing: \"0.4px\",\n  opacity: 0.75,\n  textTransform: \"uppercase\",\n  fontSize: 12,\n};\n\nconst h1 = {\n  margin: \"8px 0 6px\",\n  fontSize: 28,\n  lineHeight: 1.05,\n  fontWeight: 950,\n  letterSpacing: \"-0.4px\",\n};\n\nconst p = {\n  margin: 0,\n  opacity: 0.8,\n  lineHeight: 1.4,\n};\n\nconst earnedWrap = {\n  width: \"100%\",\n  maxWidth: 980,\n  margin: \"0 auto\",\n  display: \"grid\",\n  placeItems: \"center\",\n  paddingTop: 16,\n};\n\nconst card = {\n  width: \"100%\",\n  borderRadius: 20,\n  border: \"1px solid rgba(255,255,255,.14)\",\n  background: \"rgba(0,0,0,.28)\",\n  boxShadow: \"0 20px 70px rgba(0,0,0,.35)\",\n  padding: \"16px 14px\",\n};\n\nconst statGrid = {\n  display: \"grid\",\n  gridTemplateColumns: \"1fr 1fr\",\n  gap: 10,\n  marginTop: 14,\n};\n\nconst statItem = {\n  borderRadius: 16,\n  border: \"1px solid rgba(255,255,255,.12)\",\n  background: \"rgba(0,0,0,.18)\",\n  padding: \"12px 12px\",\n};\n\nconst statKey = {\n  opacity: 0.75,\n  fontSize: 12,\n  fontWeight: 850,\n  letterSpacing: \"0.3px\",\n  textTransform: \"uppercase\",\n};\n\nconst statVal = {\n  marginTop: 8,\n  fontSize: 18,\n  fontWeight: 950,\n};\n\nconst tinyRow = {\n  display: \"flex\",\n  gap: 10,\n  marginTop: 12,\n};\n\nconst pill = {\n  borderRadius: 999,\n  padding: \"10px 12px\",\n  fontWeight: 850,\n  border: \"1px solid rgba(255,255,255,.12)\",\n  background: \"rgba(0,0,0,.18)\",\n};\n\nconst terminal = {\n  marginTop: 12,\n  borderRadius: 16,\n  border: \"1px solid rgba(255,255,255,.12)\",\n  background: \"rgba(0,0,0,.24)\",\n  padding: \"12px 12px\",\n  fontFamily:\n    'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace',\n  fontSize: 12,\n  opacity: 0.9,\n};\n\nconst primaryBtn = {\n  marginTop: 14,\n  width: \"100%\",\n  borderRadius: 999,\n  padding: \"12px 14px\",\n  fontWeight: 950,\n  border: \"1px solid rgba(255,255,255,.18)\",\n  background:\n    \"linear-gradient(90deg, rgba(255,210,122,.25), rgba(158,231,255,.18))\",\n  color: \"white\",\n  cursor: \"pointer\",\n};\n\nconst finePrint = {\n  marginTop: 10,\n  fontSize: 12,\n  opacity: 0.65,\n  textAlign: \"center\",\n};\n"],"names":[],"mappings":"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"}}]
}